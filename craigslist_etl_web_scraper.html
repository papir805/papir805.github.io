<!DOCTYPE HTML>
<!--
	Dopetrope by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Project: ETL Craigslist Web Scraper</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="no-sidebar is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<section id="header">

					<!-- Logo -->
					<h1>
						Using mathematics to solve problems with real-world data excites me.
					</h1>

				<!-- Nav -->
				<nav id="nav">
					<ul>
						<li>
							<a href="index.html">Home</a>
						</li>
						<li  class="current">
							<a href="#">Projects</a>
							<ul>
								<li>
									<a href="featured_projects.html">Featured Projects</a>
									<ul>
										<li>
											<a href="#">Bot Battles Player Analysis</a>
											<ul>
												<li>
													<a href='bot_battles_introduction.html'>An Introduction</a>
												</li>
												<li>
													<a href="bot_battles_data_cleaning.html">Part 1: Data Cleaning</a>
												</li>
												<li>
													<a href="bot_battles_exploratory_data_analysis.html">Part 2: EDA</a>
												</li>
												<!-- <li>
													<a href="bot_battles_correlation.html">Part 3: Correlation</a>
												</li> -->
											</ul>
										</li>
										<li>
											<a href="electronicart_sales_analysis.html">ElectroniCart Sales Analysis</a>
										</li>
										<li>
											<a href="telepulse_ad_campaign_report.html">TelePulse Ad Campaign Report</a>
										</li>
									</ul>
								</li>
								<li>
									<a href="personal_projects.html">Personal Projects</a>
									<ul>
										<li>
											<a href="acupuncture_analysis.html">Acupuncture Analysis</a>
										</li>
										<li>
											<a href='#'>Math Tutoring Rate Analysis </a>
											<ul>
												<li>
													<a href="craigslist_etl_web_scraper.html">Part 1: Web Scraper</a>
												</li>
												<li>
													<a href="craigslist_EDA.html">Part 2: EDA</a>
												</li>
												<li>
													<a href="craigslist_tableau_dashboard.html">Part 3: Tableau Dashboard</a>
												</li>
											</ul>
										</li>							
										<li>
											<a href="datasheet_qa_tool.html">Data Sheet Question Answering Tool</a>
										</li>
										
										<li>
											<a href="pokemon_classifier.html">Pokémon Classification</a>
										</li>
										<li>
											<a href="islr_python.html">Porting Code From ISLR2e</a>
										</li>
										<li>
											<a href='#'>U.S. Accounting Survey Analysis </a>
											<ul>
												<li>
													<a href="us_accounting_survey_analysis.html">Part 1: Analysis</a>
												</li>
												<li>
													<a href="us_accounting_viz.html">Part 2: Gender Salary Gap</a>
												</li>
											</ul>
										</li>		
										<li>
	<!-- 									<li>
											<a href="sql_queries.html">SQL Queries</a>
										</li> -->
									</ul>
								</li>
							</ul>
						</li>
						<li>
							<a href="resume/jonathan_papir_resume2.pdf">Resume</a>
							<!-- <a href="https://drive.google.com/file/d/1RAcaKhw9TIj3sL1ute5pMXsO_pgfHx5R/view?usp=sharing">Resume</a> -->
						</li>
						<li>
							<a href="about.html">About</a>
						</li>
							<!-- <li><a href="tbd_sidebar.html">tbd</a></li> -->
					</ul>
				</nav>
				</section>

			<!-- Main -->
				<section id="main">
					<div class="container">

						<!-- Content -->
							<article class="box post">
								<a href="#" class="image featured"><img src="images/etl_craigslist_web_scraper/etl_thumbnail.png" alt="" style="height: 400px;"/></a>
								<header>
									<h2>
										Extract, Transform, Load (ETL) Craigslist Web Scraper
									</h2>
									<p>
									Goal: To curate a dataset of math tutoring prices that can be used to understand the local and national competition.
									</p>
									<i class="icon solid fa-code"> Python, PostgreSQL, HTML, RegEx</i>
									<br>
									<i class="icon solid fa-chart-line"> Web Scraping, Data Cleaning</i>
								</header>
								<p>
									<h3>
										<u>Background</u>
									</h3>
									As someone who runs a tutoring business where a large portion of its business comes from Craigslist , I wanted to understand what competing tutors were charging nearby and in other parts of the country. Using Python, I built this web scraper to extract the prices of tutors from posts found in Craigslist's services section.
									<br>
									<br>
									The full project can be found on <a href="https://github.com/papir805/craigslist_web_scraper">my GitHub</a>.
								</p>
								<p>
									<h5>
										The process:
									</h5>
									<ol>
										<li>
											Extract posting information from Craigslist.
										</li>
										<li>
											Transform the data to my own specifications.
										</li>
										<li>
											Load the data into a PostgreSQL database.
										</li>
									</ol>
								</p>
								<section>
										<h3>
											<u>Part 1: Extract</u>
										</h3>
										<i class="icon solid fa-book"> Pandas, Requests and BeautifulSoup</i>
										<p>
										To begin, I created functions that would perform various tasks necessary to scrape posting information for Craigslist.
										</p>
										<ol>
											<li>
												get_state_and_region_tags():
												<ul>
													<li>
														Extracts the state and region names for all geographic areas.
													</li>
													<li>
														Ex: California - Sacramento, California - SFbayarea,
														Florida - Miami
													</li>
												</ul>
											</li>
											<li>
												get_state_to_region_dict():
												<ul>
													<li>
														Uses state and region names to construct a dictionary containing URLs for each unique state and region pair.
													</li>
													<li>
														Ex: sacramento.craigslist.org, sfbayarea.craigslist.org, miami.craigslist.org
													</li>
												</ul>
											</li>
											<li>
												get_region_search_page_urls():
												<ul>
													<li>
														Initiate an HTTP request to each URL and perform a search for "math tutor" in the services section of each region.  Extracts the HTML of the search results.
													</li>
												</ul>
											</li>
											<li>
												get_urls_of_posts():
												<ul>
													<li>
														Crawls the HTML of the search results page, extracting the URL of each posting contained within.
													</li>
												</ul>
											</li>
											<li>
												convert_urls_to_soup_objs():
												<ul>
													<li>
														Extracts and parses the HTML code from every posting using BeautfulSoup.
													</li>
												</ul>
											</li>
											<!-- <li>
												extract_post_features():
												<ul>
													<li>
														Extracts pricing information using REGEX from each posting and stores it in a Pandas DataFrame.
													</li>
												</ul>
											</li> -->
										</ol>
								</section>
								<section>
									<header>
										<h3>
											<u>Part 2: Transform</u>
										</h3>
										<i class="icon solid fa-book"> Pandas, NumPy, and Sklearn</i>
									</header>
									<p>
										Next, I began inspecting the posts to determine the best way to extract the information I wanted.
									</p>
										<h4>
											2.1 Drop duplicate posts
										</h4>
									<p>
										I was surprised to find that, although I had scraped 4,720 postings nationwide, only 1,257 of them were unique.   I discovered that many math tutors place ads in multiple geographic locations, hence why there were so many duplicate postings.
									</p>
									<p>
										Investigating further, I found some tutors change the wording of their posts, making detection difficult.  Instead of removing posts with text that matches character for character, I had to get creative.  In the end, I solved the problem using vector embeddings and something known as the cosine similarity ratio.  By calculating the ratio between each pair of postings, I could identify when a post was "similar enough" to another posting and mark it as a duplicate for subsequent removal.  After removing these posts, only 685 remained, or about 15.41% of the posts that were originally scraped.
									</p>
										<h4>
											2.2 Determining the hourly rate
										</h4>
									<p>
										Reading through some of the postings showed they can be fairly different from tutor to tutor. One post may have no pricing information, while another post can have a single flat hourly rate, and others can have more complicated pricing schedules that change based on the length of a tutoring session (ex: $30 for 1 hr, $50 for 2 hrs), or a multitude of other factors like the subject tutored (ex: algebra vs. calculus). 
									</p>
									<p>
										My plan for extracting the different prices depended on how complicated the pricing schedule was. First, I used RegEx to identify any postings without any pricing information and excluded them from the analysis.  This brought the number of postings down to 300.  From there, any posts that had a single hourly rate were kept, and I used RegEx to extract the pricing information.  However, the implementation for handling posts with two or more prices is as follows:
										<ul> 
											<li>
												If two prices were mentioned in a post, extract them using RegEx and average them.
											</li>
											<li>
												If three or more prices are mentioned, flag the post, then manually inspect and determine the price later.
											</li>
										</ul> 
									</p>
								</section>
								<section>
									<header>
										<h3>
											<u>Part 3: Load</u>
										</h3>
										<i class="icon solid fa-book"> Pandas and Psycopg2</i>
									</header>
									<p>
										After transforming the data, it gets loaded into a Pandas DataFrame, exported to an Excel CSV file, and then Psycopg2 inserts rows from the CSV file into a local PostgreSQL database.
									</p>
									<p>
										The analysis of the data that was collected can be found <a href='craigslist_EDA.html'>here</a>.
									</p>
								</section>
							</article>
					</div>
				</section>

			<!-- Footer -->
				<section id="footer">
					<div class="container">
						<!-- <div class="row">
							<div class="col-8 col-12-medium">
								<section>
									<header>
										<h2>Blandit nisl adipiscing</h2>
									</header>
									<ul class="dates">
										<li>
											<span class="date">Jan <strong>27</strong></span>
											<h3><a href="#">Lorem dolor sit amet veroeros</a></h3>
											<p>Ipsum dolor sit amet veroeros consequat blandit ipsum phasellus lorem consequat etiam.</p>
										</li>
										<li>
											<span class="date">Jan <strong>23</strong></span>
											<h3><a href="#">Ipsum sed blandit nisl consequat</a></h3>
											<p>Blandit phasellus lorem ipsum dolor tempor sapien tortor hendrerit adipiscing feugiat lorem.</p>
										</li>
										<li>
											<span class="date">Jan <strong>15</strong></span>
											<h3><a href="#">Magna tempus lorem feugiat</a></h3>
											<p>Dolore consequat sed phasellus lorem sed etiam nullam dolor etiam sed amet sit consequat.</p>
										</li>
										<li>
											<span class="date">Jan <strong>12</strong></span>
											<h3><a href="#">Dolore tempus ipsum feugiat nulla</a></h3>
											<p>Feugiat lorem dolor sed nullam tempus lorem ipsum dolor sit amet nullam consequat.</p>
										</li>
										<li>
											<span class="date">Jan <strong>10</strong></span>
											<h3><a href="#">Blandit tempus aliquam?</a></h3>
											<p>Feugiat sed tempus blandit tempus adipiscing nisl lorem ipsum dolor sit amet dolore.</p>
										</li>
									</ul>
								</section>
							</div>
							<div class="col-4 col-12-medium">
								<section>
									<center>
										<header>
											<h2 style="color:black;">Socials</h2>
										</header>
									</center>
									<center>
										<ul class="social">
											<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
											<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
										</ul>
									</center>
								</section>
							</div> -->
<!-- 							<div class="col-4 col-6-medium col-12-small">
								<section>
									<center>
										<header>
											<h2 style="color:black;">Socials</h2>
										</header>
									</center>
									<center>
										<ul class="social">
											<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
											<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
										</ul>
									</center>
								</section>
							</div> -->
							<div class="col-4 col-6-medium col-12-small">
								<div class="right">
									<section>
										<center>
											<header>
												<h2>Socials</h2>
											</header>
										</center>
										<center>
											<ul class="social">
												<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
		<!-- 										<li><a class="icon solid fa-envelope" href="mailto:papir805@gmail.com"><span class="label">Email</span></a></li> -->
												<!-- <li><a class="icon brands fa-dribbble" href="#"><span class="label">Dribbble</span></a></li>
												<li><a class="icon brands fa-tumblr" href="#"><span class="label">Tumblr</span></a></li> -->
												<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
											
											</ul>
											<ul class="contact">
											<!-- <li>
												<h3>Address</h3>
												<p>
													Untitled Incorporated<br />
													1234 Somewhere Road Suite<br />
													Nashville, TN 00000-0000
												</p>
											</li> -->
											<li>
												<h3>E-mail:</h3>
												<p><a href="mailto:papir805@gmail.com">papir805@gmail.com</a></p>
											</li>
											<!-- <li>
												<h3>Phone</h3>
												<p>(800) 000-0000</p>
											</li> -->
										</ul>

										</center>
									</section>
								</div>
							</div>
<!-- 							<div class="col-4 col-12-medium">
								<section>
									<center>
										<header>
											<h2 style="color:black;">Socials</h2>
										</header>
									</center>
									<center>
										<ul class="social">
											<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
											<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
										</ul>
									</center>
									<ul class="contact">
										<li>
											<h3>Address</h3>
											<p>
												Untitled Incorporated<br />
												1234 Somewhere Road Suite<br />
												Nashville, TN 00000-0000
											</p>
										</li>
										<li>
											<h3 style="color:black;">E-mail:</h3>
											<p><a href="mailto:papir805@gmail.com">papir805@gmail.com</a></p>
										</li>
										<li>
											<h3>Phone</h3>
											<p>(800) 000-0000</p>
										</li>
									</ul>
								</section>
							</div> -->
							<div class="col-12">

								<!-- Copyright -->
									<div id="copyright">
										<ul class="links">
											<li>&copy; Jonathan Papir. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
										</ul>
									</div>

							</div>
						<!-- </div> -->
					</div>
				</section>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>