<!DOCTYPE HTML>
<!--
	Dopetrope by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>ISLR (2e) Chapter 10 Labs</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../../assets/css/main.css" />
        <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
	</head>
	<style>
		pre {
    white-space: pre-wrap;
/*background: hsl(30,80%,90%);*/
}
</style>
	<body class="no-sidebar is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<section id="header">

					<!-- Logo -->
						<h1>Using mathematics to solve problems with real world data excites me.</h1>

					<!-- Nav -->
						<nav id="nav">
							<ul>
								<li>
									<a href="index.html">Home</a>
								</li>
								<li class="current">
									<a href="portfolio.html">Portfolio</a>
									<ul>
										<li>
											<a href="reddit_accounting_survey_analysis.html">Reddit Accounting Survey Analysis</a>
										</li>
										<li>
											<a href="us_accounting_viz.html">U.S. Accounting Viz</a>
										</li>
										<li>
											<a href="etl_craigslist_web_scraper.html">ETL Craigslist Web Scraper</a>
										</li>
										<li>
											<a href="craigslist_EDA.html">Craigslist Tutoring EDA</a>
										</li>
										<li>
											<a href="craigslist_tableau.html">National Tutoring Prices Dashboard</a>
										</li>
										<li>
											<a href="tv_ad_report.html">TV Advertising Report</a>
										</li>
										<li>
											<a href="sql_queries.html">SQL Queries</a>
											<!-- <ul>
												<li><a href="#">Magna phasellus</a></li>
												<li><a href="#">Etiam dolore nisl</a></li>
												<li><a href="#">Veroeros feugiat</a></li>
												<li><a href="#">Nisl sed aliquam</a></li>
												<li><a href="#">Dolore adipiscing</a></li>
											</ul> -->
										</li>
										<li>
											<a href="pokemon_classifier.html">Pok√©mon Classification</a>
										</li>
										<li>
											<a href="acupuncture_analysis.html">Acupuncture Analysis</a>
										</li>
									</ul>
								</li>
								<li><a href="https://drive.google.com/file/d/1B_CcPaHRbLbAyZ3RoUIeKbmIT0T0Y1l0/view?usp=sharing">Resume</a></li>
								<li><a href="about.html">About</a></li>
								<!-- <li><a href="tbd_sidebar.html">tbd</a></li> -->
							</ul>
						</nav>

				</section>

			<!-- Main -->
				<section id="main">
					<div class="container">

						<!-- Content -->
							<article class="box post">
<!-- 								<a href="#" class="image featured"><img src="images/pic01.jpg" alt="" /></a> -->
								<header>
									<h2>Chapter 10: Deep Learning Lab</h2>
									<p></p>
									<i class="icon solid fa-code">
										 R and Python
										</i>
										<br>
										<i class="icon solid fa-chart-line">  NumPy, Pandas, Statsmodels, Sklearn, Tensorflow/Keras, Matplotlib, glmnet_python</i>
								</header>
								<p>
									<h3>Summary:</h3>
									This post is mainly to summarize the process of porting the R code to Python and only goes into detail on the things that were challenging or significant in some way.  

									<br>
									To see the Jupyter Notebook with the full Python code, you can: <a href="https://nbviewer.org/github/papir805/ISLR2/blob/master/Python/chp10/labs/chp_10_lab_me.ipynb">click here</a>
								</p>
								<h4><u>Lab 10.9.1: A Single Layer Network on the Hitters Data</u></h4>
								<p>

									The lab starts by loading the dataset from the ISLR2 library, dropping null values, and then generates indices that will separate training data from testing data.

<table>
  <tr>
    <td>
    	<h5>R Code</h5>
    	<pre>
									  <code class="r">
	    library(ISLR2)
	    Gitters <- na.omit(Hitters) > n <- nrow(Gitters)
	    set.seed(13)
	    ntest <- trunc(n / 3)
	    testid <- sample(1:n, ntest)
									  </code>
									</pre></td>
    <td>
    	<h5>Python Code</h5>
    	<pre>
									  <code class="Python">
	    import rpy2.robjects as robjects

	    data = robjects.r("""
		library(ISLR2)
		n <- nrow(na.omit(Hitters))
		set.seed(13)
		ntest <- trunc(n / 3)
		testid <- sample(1:n, ntest)
		""")
									  </code>
									</pre></td>
  </tr>
</table>

									

									Because the test indices are randomly generated from R's sample function, it would be difficult to replicate the results in Python.  The solution is to use a python library called <a href="https://rpy2.github.io/doc/latest/html/introduction.html">rpy2</a>, which provides an interface between the Python and R languages.

									Using rpy2, I can call the the same R code through Python and generate the testids to make the lab results reproducible.
								</p>
								
								
<p>
							In R, you can supply a vector of numbers to a dataframe and R will return the rows with indices corresponding to those numbers, however in Pandas this isn't quite as easy.  In order to get the desired rows, I created a boolean mask, which is essentially a list of True/False values.  Pandas will return rows from the dataframe that have indices corresponding to the indices of True values in the boolean mask.

							Before doing so, I needed to adjust the indices of the Pandas dataframe to have the first row correspond to an index of 1, as opposed to the default of 0.  R dataframes start indexing at 1 and this will ensure that the same rows will be returned from our boolean mask in Python. 
						</p>

<h5>Python Code</h5>
								<pre>
									  <code class="Python">
	Gitters = pd.read_csv('../../../datasets/Hitters.csv')

	Gitters = Gitters.dropna()

	# R starts indexing at 1, Python starts indexing at 0, this is to make sure the indices of the dataframes match
	Gitters = Gitters.set_index(keys=np.arange(1, len(Gitters) + 1)) 

	testid = np.sort(np.array(data))
	test_mask = Gitters.index.isin(testid)
									  </code>
									</pre>


<p>
	The next part of the lab goes on to perform lasso regression using an R library known as <code class='r'>glmnet</code>.  First, the lab creates a design matrix, scales the data using standard scaling, and excludes the constant.  A <a href="https://www.statlect.com/glossary/design-matrix">design matrix</a> is a matrix of all the inputs to be used for some kind of regression model.  Each row in the matrix is an observation and each column represents a measured characteristic of that observation...think vectors, each row is a vector and each element of the vector is a measure of some characteristic of that vector.  By excluding the constant, the matrix will <b>not</b> append a 1 to the end of each row in the matrix.  Consequently, There will be no constant term included in the model after being fit to the dataset.
</p>

<table>
  <tr>
    <td>
    	<h5>R Code</h5>
		<pre>
			  <code class="r">
x <- model.matrix(Salary ~ . - 1, data = Gitters)
x_scale <- scale(x)
y <- Gitters$Salary

library(glmnet)
cvfit <- cv.glmnet(x_scale[-testid, ], y[-testid],
                   		  type.measure = "mae")
cpred <- predict(cvfit, x_scale[testid, ], s = "lambda.min")
mean(abs(y[testid] - cpred))
			  </code>
		</pre>
	</td>
    <td>
    	<h5>Python Code</h5>
		<pre>
			  <code class="Python">
x = patsy.dmatrix(formula_like = 
'AtBat + Hits + HmRun + Runs + 
RBI + Walks + Years + CAtBat + 
CHits + CHmRun + CRuns + CRBI + 
CWalks + League + Division + PutOuts + 
Assists + Errors + NewLeague - 1', 
data = Gitters)

x_scale = patsy.scale(x, ddof=1)

y = np.array(Gitters['Salary'])
			  </code>
		</pre>
	</td>
  </tr>
</table>







									<h3><u>The approach:</u></h3>
									GitHub repo found <a href="https://github.com/papir805/ISLR2">here</a>
									

									
                        
                        
								
								<br/>
								<h3><u>References:</u></h3>
								<p>
									James, G., Witten, D., Hastie, T., Tibshirani, R. (2021). An Introduction to Statistical Learning with Applications in R, Second Edition, Springer Science+Business Media, New York. <a href="https://www.statlearning.com/">https://www.statlearning.com/</a>
								</p>
								<!-- <section>
									<header>
										<h3>Something else</h3>
									</header>
									<p>
										Elementum odio duis semper risus et lectus commodo fringilla. Maecenas sagittis convallis justo vel mattis.
										placerat, nunc diam iaculis massa, et aliquet nibh leo non nisl vitae porta lobortis, enim neque fringilla nunc,
										eget faucibus lacus sem quis nunc suspendisse nec lectus sit amet augue rutrum vulputate ut ut mi. Aenean
										elementum, mi sit amet porttitor lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor
										sit amet nullam consequat feugiat dolore tempus.
										Elementum odio duis semper risus et lectus commodo fringilla. Maecenas sagittis convallis justo vel mattis.
										placerat, nunc diam iaculis massa, et aliquet nibh leo non nisl vitae porta lobortis, enim neque fringilla nunc,
										eget faucibus lacus sem quis nunc suspendisse nec lectus sit amet augue rutrum vulputate ut ut mi. Aenean
										elementum, mi sit amet porttitor lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor.
									</p>
								</section>
								<section>
									<header>
										<h3>So in conclusion ...</h3>
									</header>
									<p>
										Nunc diam iaculis massa, et aliquet nibh leo non nisl vitae porta lobortis, enim neque fringilla nunc,
										eget faucibus lacus sem quis nunc suspendisse nec lectus sit amet augue rutrum vulputate ut ut mi. Aenean
										elementum, mi sit amet porttitor lorem ipsum dolor sit amet, consectetur adipiscing elit. Lorem ipsum dolor
										sit amet nullam consequat feugiat dolore tempus. Elementum odio duis semper risus et lectus commodo fringilla.
										Maecenas sagittis convallis justo vel mattis.
									</p>
								</section> -->
							</article>

					</div>
				</section>

			<!-- Footer -->
				<section id="footer">
					<div class="container">
						<!-- <div class="row">
							<div class="col-8 col-12-medium">
								<section>
									<header>
										<h2>Blandit nisl adipiscing</h2>
									</header>
									<ul class="dates">
										<li>
											<span class="date">Jan <strong>27</strong></span>
											<h3><a href="#">Lorem dolor sit amet veroeros</a></h3>
											<p>Ipsum dolor sit amet veroeros consequat blandit ipsum phasellus lorem consequat etiam.</p>
										</li>
										<li>
											<span class="date">Jan <strong>23</strong></span>
											<h3><a href="#">Ipsum sed blandit nisl consequat</a></h3>
											<p>Blandit phasellus lorem ipsum dolor tempor sapien tortor hendrerit adipiscing feugiat lorem.</p>
										</li>
										<li>
											<span class="date">Jan <strong>15</strong></span>
											<h3><a href="#">Magna tempus lorem feugiat</a></h3>
											<p>Dolore consequat sed phasellus lorem sed etiam nullam dolor etiam sed amet sit consequat.</p>
										</li>
										<li>
											<span class="date">Jan <strong>12</strong></span>
											<h3><a href="#">Dolore tempus ipsum feugiat nulla</a></h3>
											<p>Feugiat lorem dolor sed nullam tempus lorem ipsum dolor sit amet nullam consequat.</p>
										</li>
										<li>
											<span class="date">Jan <strong>10</strong></span>
											<h3><a href="#">Blandit tempus aliquam?</a></h3>
											<p>Feugiat sed tempus blandit tempus adipiscing nisl lorem ipsum dolor sit amet dolore.</p>
										</li>
									</ul>
								</section>
							</div>
							<div class="col-4 col-12-medium">
								<section>
									<center>
										<header>
											<h2 style="color:black;">Socials</h2>
										</header>
									</center>
									<center>
										<ul class="social">
											<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
											<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
										</ul>
									</center>
								</section>
							</div> -->
<!-- 							<div class="col-4 col-6-medium col-12-small">
								<section>
									<center>
										<header>
											<h2 style="color:black;">Socials</h2>
										</header>
									</center>
									<center>
										<ul class="social">
											<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
											<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
										</ul>
									</center>
								</section>
							</div> -->
							<div class="col-4 col-6-medium col-12-small">
								<div class="right">
									<section>
										<center>
											<header>
												<h2>Socials</h2>
											</header>
										</center>
										<center>
											<ul class="social">
												<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
		<!-- 										<li><a class="icon solid fa-envelope" href="mailto:papir805@gmail.com"><span class="label">Email</span></a></li> -->
												<!-- <li><a class="icon brands fa-dribbble" href="#"><span class="label">Dribbble</span></a></li>
												<li><a class="icon brands fa-tumblr" href="#"><span class="label">Tumblr</span></a></li> -->
												<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
											
											</ul>
											<ul class="contact">
											<!-- <li>
												<h3>Address</h3>
												<p>
													Untitled Incorporated<br />
													1234 Somewhere Road Suite<br />
													Nashville, TN 00000-0000
												</p>
											</li> -->
											<li>
												<h3>E-mail:</h3>
												<p><a href="mailto:papir805@gmail.com">papir805@gmail.com</a></p>
											</li>
											<!-- <li>
												<h3>Phone</h3>
												<p>(800) 000-0000</p>
											</li> -->
										</ul>

										</center>
									</section>
								</div>
							</div>
<!-- 							<div class="col-4 col-12-medium">
								<section>
									<center>
										<header>
											<h2 style="color:black;">Socials</h2>
										</header>
									</center>
									<center>
										<ul class="social">
											<li><a class="icon brands fa-github" href="https://github.com/papir805"><span class="label">GitHub</span></a></li>
											<li><a class="icon brands fa-linkedin-in" href="https://www.linkedin.com/in/jonathan-papir/"><span class="label">LinkedIn</span></a></li>
										</ul>
									</center>
									<ul class="contact">
										<li>
											<h3>Address</h3>
											<p>
												Untitled Incorporated<br />
												1234 Somewhere Road Suite<br />
												Nashville, TN 00000-0000
											</p>
										</li>
										<li>
											<h3 style="color:black;">E-mail:</h3>
											<p><a href="mailto:papir805@gmail.com">papir805@gmail.com</a></p>
										</li>
										<li>
											<h3>Phone</h3>
											<p>(800) 000-0000</p>
										</li>
									</ul>
								</section>
							</div> -->
							<div class="col-12">

								<!-- Copyright -->
									<div id="copyright">
										<ul class="links">
											<li>&copy; Jonathan Papir. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
										</ul>
									</div>

							</div>
						<!-- </div> -->
					</div>
				</section>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>